<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Blob Test page</title>
    <script src="js/jquery-3.1.0.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body style="width: 86%; margin: 0 auto;">
<br>
<br>

<img id="imagePreview" src="" alt="Item Image" width="480" height="360"/>
<br>
<br>

<input id="imgInput" type="file"  name="file" />
<br>
<br>
<input id="idInput" type="text"  name="idfile" placeholder="UserId" />
<br>
<br>
<button id="Button1" class="btn btn-primary" onclick="saveimage();">save image</button>


<script>
    $(document).ready(function () {
        $("#imgInput").change(function () {
            readURL(this);
        });
    });
    function readURL(input) {
        if (input.files && input.files[0]) {
            let reader = new FileReader();
            reader.onload = function (e) {
                $('#imagePreview').attr('src', e.target.result);
            };
            reader.readAsDataURL(input.files[0]);
        }
    }
    function saveimage() {
        let images = $('#imagePreview').attr('src');
        let userId = $('#idInput').val();
        let ImageSave = images.replace("data:image/jpeg;base64,", "");
        let submitval = JSON.stringify({
            UserId:userId,
            DateSubmitted:"23-Feb-2017",
            ReadValue:"12345678",
            PhotoUrl:"",
            PhotoRawData: ImageSave
        });

        $.ajax({
            type: "POST",
            contentType: "application/json;charset=utf-8",
            datatype: "json",
            data: submitval,
            url: "http://localhost:8281/api/meterservice/AddElectricityRead",
            success: function (data) {
                console.log("//code for success");
            },
            error: function(error){
                let errorMsg = JSON.stringify(error);
                alert("Error: " + errorMsg);
            }
        });
    }
</script>

<!--http://localhost:8281/api/meterservice/AddElectricityRead-->

</body>
</html>